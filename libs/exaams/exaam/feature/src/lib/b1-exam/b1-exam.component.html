@if (exam) {
  <div class="flex flex-col justify-center p-5 py-10 bg-white gap-5 h-full">
    <form [formGroup]="answersForm">
      <h2
        class="text-4xl text-center border-2 border-gray-500 rounded-md p-10 mb-10 max-w-[1024px]">{{ exam.name }}</h2>

      <section formGroupName="readingTask1" class="pb-10 max-w-[1024px]" id="lesenTeil1">
        <lib-b1-exam-task-content [readingTask]="exam.readingTask1"></lib-b1-exam-task-content>

        <!--questions-->
        <div>
          @for (question of exam.readingTask1.questions; track question.id; let i = $index) {
            @if (question.questionNumber === 0) {
              <lib-task-example-container>
                <div class="flex flex-row justify-between mt-5 lg:gap-96">
                  <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                  <p class="font-bold justify-self-end">{{ question.correctAnswer }}</p>
                </div>
              </lib-task-example-container>
            } @else {
              <div class="flex flex-row justify-between mt-5 lg:gap-96">
                <p class="mb-5"><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                <select [formControlName]="i"
                        class="justify-self-end">
                  <option value="" selected disabled hidden>--Option auswählen--</option>
                  @for (option of question.options; track option) {
                    <option value="{{option}}">{{ option }}</option>
                  }
                </select>

              </div>
            }
          }
        </div>
      </section>

      <section id="lesenTeil2a" formGroupName="readingTask2a" class="pb-10 max-w-[1024px]">
        <lib-b1-exam-task-content [readingTask]="exam.readingTask2a"></lib-b1-exam-task-content>
        <!--questions-->
        @for (question of exam.readingTask2a.questions; track question.id; let i = $index) {
          @if (question.questionNumber === 0) {
            <lib-task-example-container>

              <div class="grid grid-cols-2 lg:gap-x-48">
                <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                <div>
                  @for (option of question.options; track option; let j = $index) {

                    @if (option === question.correctAnswer) {
                      <atomic-input [isDisabled]="true" [checked]="true" type="checkbox">
                        <p *ngIf="j === 0"><b> a. </b></p>
                        <p *ngIf="j === 1"><b> b. </b></p>
                        <p *ngIf="j === 2"><b> c. </b></p>
                        {{ option }}
                      </atomic-input>
                    } @else {
                      <atomic-input [isDisabled]="true" type="checkbox">
                        <p *ngIf="j === 0"><b> a. </b></p>
                        <p *ngIf="j === 1"><b> b. </b></p>
                        <p *ngIf="j === 2"><b> c. </b></p>
                        {{ option }}
                      </atomic-input>
                    }
                  }
                </div>
              </div>
            </lib-task-example-container>
          } @else {
            <div class="flex flex-col gap-5 mt-5">
              <div class="grid grid-cols-2 lg:gap-x-48">
                <div class="flex flex-row">
                  <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                </div>
                <div class="flex flex-col justify-start">
                  @for (option of question.options; track option; let j = $index) {

                    <atomic-input id="{{j + '' + question.questionNumber}}"
                                  (change)="onCheckboxChange(option, question.questionNumber)"
                                  [formControlName]="question.questionNumber"
                                  type="checkbox"
                                  [checkBoxValue]="option">
                      <p *ngIf="j === 0"><b> a. </b></p>
                      <p *ngIf="j === 1"><b> b. </b></p>
                      <p *ngIf="j === 2"><b> c. </b></p>
                      {{ option }}
                    </atomic-input>
                  }
                </div>
              </div>
            </div>
          }
        }
      </section>

      <section id="lesenTeil2b" formGroupName="readingTask2b" class="pb-10 max-w-[1024px]">
        <lib-b1-exam-task-content [readingTask]="exam.readingTask2b"></lib-b1-exam-task-content>
        <!--questions-->
        @for (question of exam.readingTask2b.questions; track question.id; let i = $index) {
          @if (question.questionNumber === 0) {
            <lib-task-example-container>
              <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
              <div class="flex flex-col">
                @for (option of question.options; track option; let j = $index) {

                  @if (option === question.correctAnswer) {
                    <atomic-input [isDisabled]="true" [checked]="true" type="checkbox">
                      <p *ngIf="j === 0"><b> a. </b></p>
                      <p *ngIf="j === 1"><b> b. </b></p>
                      <p *ngIf="j === 2"><b> c. </b></p>
                      <span>

                      {{ option }}
                      </span>
                    </atomic-input>
                  } @else {
                    <atomic-input [isDisabled]="true" type="checkbox">
                      @switch (j) {
                        @case (0) {
                          <p><b> a. </b></p>
                        }
                        @case (1) {
                          <p><b> b. </b></p>
                        }
                        @case (2) {
                          <p><b> c. </b></p>
                        }
                      }
                      {{ option }}
                    </atomic-input>
                  }
                }
              </div>
            </lib-task-example-container>
          } @else {
            <div class="flex flex-col gap-5 mt-5">
              <div class="grid grid-cols-2 lg:gap-x-48">
                <div class="flex flex-row">
                  <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                </div>
                <div class="flex flex-col justify-start">
                  @for (option of question.options; track option; let j = $index) {

                    <atomic-input id="{{j + '' + question.questionNumber}}"
                                  (change)="onCheckboxChange(option, question.questionNumber)"
                                  [formControlName]="question.questionNumber"
                                  type="checkbox"
                                  [checkBoxValue]="option">
                      @switch (j) {
                        @case (0) {
                          <p><b> a. </b></p>
                        }
                        @case (1) {
                          <p><b> b. </b></p>
                        }
                        @case (2) {
                          <p><b> c. </b></p>
                        }
                      }
                      {{ option }}
                    </atomic-input>
                  }
                </div>
              </div>
            </div>
          }
        }
      </section>

      <section id="lesenTeil3" formGroupName="readingTask3" class="pb-10 max-w-[1024px]">
        <lib-b1-exam-task-content [readingTask]="exam.readingTask3"></lib-b1-exam-task-content>
        <p class="italic my-4 font-semibold">{{ exam.readingTask3.textContents }}</p>

        @for (question of exam.readingTask3.questions; track question.id; let i = $index) {
          @if (question.questionNumber === 0) {
            <lib-task-example-container>
              <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
              <p class="font-bold justify-self-end">{{ question.correctAnswer.toUpperCase() }}</p>
            </lib-task-example-container>
          } @else {
            <div class="grid grid-cols-3 mt-5 justify-between">
              <p class="mb-5 col-span-2"><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
              <select [formControlName]="question.questionNumber" class="justify-self-end">
                <option value="" selected disabled hidden>--Option auswählen--</option>
                @for (option of question.options; track option) {

                  <option [ngClass]="{
                    hidden: chosenOptions().includes(option)
                    }" value="{{option}}">
                    {{ option.toUpperCase() }}
                  </option>
                }
              </select>
            </div>
          }
        }
        <div class="flex justify-center w-full mt-5">
          <img [src]="exam.readingTask3ImageUrls" alt="Anzeige Bilder Fuer Teil 3">
        </div>
      </section>

      <section id="lesenTeil4" formGroupName="readingTask4" class="pb-10 max-w-[1024px]">
        <lib-b1-exam-task-content [readingTask]="exam.readingTask4"></lib-b1-exam-task-content>

        <p class="italic my-4 font-semibold">{{ exam.readingTask4.textContents }}</p>

        @for (question of exam.readingTask4.questions; track question.id; let i = $index) {
          @if (question.questionNumber === 0) {
            <div class="max-w-[420px] max-h-[350px] mb-4">
              <lib-task-example-container class="">
                <div class="flex flex-row justify-between">
                  <p><b>{{ question.questionNumber }}.</b> {{ question.questionText }}</p>
                  <lib-yes-no [question]="question"></lib-yes-no>
                </div>
              </lib-task-example-container>
            </div>
          }
        }
        <div  class="columns-1 md:columns-2 gap-5 w-full">
          @for (question of exam.readingTask4.questions; track question.id; let i = $index) {
            @if (question.questionNumber !== 0) {
              <div class="flex flex-row justify-between max-w-[420px] mb-4">
                <p><b>{{ question.questionNumber }}.</b> {{ question.questionText }}</p>
                <lib-yes-no [formControlName]="question.questionNumber" [question]="question"></lib-yes-no>
              </div>
            }
          }
        </div>
        <p class="italic my-4 font-semibold">Leserkommentare</p>
        <div class="flex flex-col gap-5">
          @for (question of exam.readingTask4.questions; track question.id; let i = $index) {
            @if (question.questionNumber ===0){
              <lib-task-example-container>
                <div class="flex flex-row justify-between">
                  <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                </div>
              </lib-task-example-container>
            } @else{
              <div class="flex flex-row justify-between">
                <p><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
              </div>
            }
          }
        </div>
      </section>

      <section id="lesenTeil5" class="max-w-[1024px] pb-10" formGroupName="readingTask5">
        <lib-b1-exam-task-content [readingTask]="exam.readingTask5"></lib-b1-exam-task-content>
        <div class="grid md:grid-cols-2 mt-10 lg:pl-5">
          @for (question of exam.readingTask5.questions; track question.id; let i = $index) {

              <div class="rows-2 mt-4">
                <div class="">
                  <p class="font-bold mb-2"><b>{{ question.questionNumber }}.</b> {{ question.statement }}</p>
                </div>
                <div class="flex flex-col justify-start">
                  @for (option of question.options; track option; let j = $index) {

                    <atomic-input id="{{j + '' + question.questionNumber}}"
                                  (change)="onCheckboxChange(option, question.questionNumber)"
                                  [formControlName]="question.questionNumber"
                                  type="checkbox"
                                  [checkBoxValue]="option">
                      @switch (j) {
                        @case (0) {
                          <p><b> a. </b></p>
                        }
                        @case (1) {
                          <p><b> b. </b></p>
                        }
                        @case (2) {
                          <p><b> c. </b></p>
                        }
                      }
                      {{ option }}
                    </atomic-input>
                  }
                </div>
              </div>



          }
        </div>
      </section>

      <section id="submit">
        <atomic-button (click)="submitAnswers()">Schicken</atomic-button>
      </section>

    </form>
  </div>
}
